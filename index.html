<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>360video â€” Valiant360 player</title>
    <style>
      html,body{height:100%;margin:0;background:#111;color:#eee;font-family:system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
      .wrap{display:flex;align-items:center;justify-content:center;height:100%;padding:1rem}
      .player{max-width:1000px;width:100%;box-shadow:0 10px 30px rgba(0,0,0,.6);background:#000}
      #container{width:100%;height:560px;background:#000}
      .note{font-size:0.9rem;margin-top:0.5rem;color:#aaa;text-align:center}
      @media (max-width:640px){ #container{height:320px} }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div>
        <div class="player">
          <!-- Valiant360 container -->
          <div id="container"></div>
        </div>
        <div class="note">Use mouse/touch to look around. Click the VR button for headset mode (if supported).</div>
      </div>
    </div>

    <!-- Fallback plain video (visible if Valiant360 fails) -->
    <video id="fallback" controls playsinline preload="metadata" crossorigin="anonymous" style="display:none;width:100%;max-width:1000px;margin:0 auto;">
      <source src="https://res.cloudinary.com/plyocom/video/upload/v1762959673/POI_anim_2_de4hux.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>

    <!-- three.js + Valiant360 (served from the Valiant360 demo site) -->
    <script src="https://flimshaw.github.io/Valiant360/js/three.min.js"></script>
    <script src="https://flimshaw.github.io/Valiant360/js/valiant360.min.js"></script>

    <script>
      (function(){
        var videoUrl = 'https://res.cloudinary.com/plyocom/video/upload/v1762959673/POI_anim_2_de4hux.mp4';

        // Basic init of Valiant360
        function initValiant(){
          try {
            var player = new Valiant360('#container', {
              video: videoUrl,
              is_stereo: false,
              is_yaw_only: false,
              is_vr: true,
              autoplay: true,
              muted: true,
              loop: true,
              debug: false
            });

            // show fallback video if Valiant360 fails to load within a few seconds
            var checkTimer = setTimeout(function(){
              if (!player || !player.playing) {
                showFallback();
              }
            }, 5000);

            if (player && player.onReady) {
              player.onReady(function(){ clearTimeout(checkTimer); });
            }
          } catch (err){
            console.error('Valiant360 init error', err);
            showFallback();
          }
        }

        function showFallback(){
          document.getElementById('container').style.display = 'none';
          var f = document.getElementById('fallback');
          f.style.display = 'block';
          try { f.muted = false; f.play(); } catch(e){}
        }

        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          initValiant();
        } else {
          window.addEventListener('DOMContentLoaded', initValiant);
        }
      })();
    </script>
  </body>
</html>